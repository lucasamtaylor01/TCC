\chapter{Introdução às equações diferenciais estocásticas}\label{cap:ch02-introducao-sde}

\section{Introdução}\label{sec:ch02_introducao_sde}

\section{Motivação} \label{sec:ch02_motivacao_sde}

Para iniciar a introdução às equações diferenciais estocásticas (EDEs), vamos apresentar a motivação para o seu estudo. Começamos com uma equação diferencial ordinária:

\begin{equation}
    \begin{cases}
        \dot{\mathbf{x}} = \mathbf{b}(\mathbf{x}(t))\\
        \mathbf{x}(0) = x_0, \label{eq:ch02_sistema_edo_generico}
    \end{cases}
\end{equation}

onde $t > 0$, $\mathbf{b}: \mathbb{R}^n \to \mathbb{R}^n$ é um vetor suave, e $\mathbf{x}(t): [0, \infty) \to \mathbb{R}^n$ representa a trajetória do sistema ao longo do tempo. O sistema \eqref{eq:ch02_sistema_edo_generico} é classificado como determinístico, pois, uma vez conhecida a condição inicial, a trajetória do sistema é totalmente determinada, conforme garante o Teorema de Existência e Unicidade.

Contudo, suponha que desejamos modelar a evolução de um fenômeno sujeito a incertezas. Em outras palavras, queremos aplicar o mesmo princípio das equações diferenciais ordinárias a um processo aleatório. Para isso, utilizamos as equações diferenciais estocásticas. Esse tipo de equação é definido como:

\begin{equation}
    \begin{cases}
        \dot{X}(t) = b(t, X(t)) + \sigma(t, X(t))\xi(t)\\
        \mathbf{X}(0) = x_0,
    \end{cases}
\end{equation}\label{eq:ch02_sistema_ede_generico}

onde $X(t) \in \mathbb{R}^d$, $b : [0,T] \times \mathbb{R}^d \mapsto \mathbb{R}^d$, e $\sigma : [0,T] \times \mathbb{R}^d \mapsto \mathbb{R}^{d \times m}$. Usamos a notação $\xi(t) = \frac{dW}{dt}$ para denotar (de forma formal) a derivada do movimento Browniano em $\mathbb{R}^m$, ou seja, um processo de ruído branco — um vetor Gaussiano generalizado, de média zero.

Como exemplo motivador para o uso de EDEs, consideremos a evolução do preço de uma ação na bolsa de valores ao longo do tempo. Esse preço é influenciado por diversos fatores externos, o que introduz um grau de incerteza quanto ao seu comportamento futuro. Assim, podemos modelá-lo por meio de uma EDE:

\begin{equation}
    \begin{cases}
        \dfrac{dS}{S} = \mu dt + \sigma dW\\
        \mathbf{S}(0) = s_0, \label{eq:ch02_exemplo_mercado_de_acoes}
    \end{cases}
\end{equation}

Nessa equação, $ \dfrac{dS}{S}$ representa a variação relativa do preço da ação ao longo do tempo; $\mu$ é uma constante positiva que representa a taxa média de crescimento; e $\sigma$ expressa a volatilidade, ou seja, a incerteza associada aos diversos fatores que influenciam no preço.

Antes de continuar com esse exemplo, apresentaremos a base teórica necessária para a formulação da equação \eqref{eq:ch02_exemplo_mercado_de_acoes}, bem como suas propriedades.

\section{Considerações estatísticas}\label{sec:ch02_consideracoes_estat}

\section{Equações diferenciais estocásticas}

Dadas as considerações estatísticas, passemos para a construção da equação \eqref{eq:ch02_sistema_ede_generico}, reproduzida novamente a seguir:
\begin{equation*}
    \begin{cases}
        \dot{X}(t) = b(t, X(t)) + \sigma(t, X(t))\,\xi(t),\\
        X(0) = x_0, \label{eq:ch02_sistema_ede_generico_2}
    \end{cases}
\end{equation*}

A solução $X(\cdot)$ é então expressa como
\begin{equation}
    X(t) = x_0 + \int_0^t b(s, X(s))\,ds + \int_0^t \sigma(s, X(s))\,dW_s. \label{eq:ch02_solucao_integral}
\end{equation}

Note que, dadas essas expressões, restam algumas definições fundamentais: a definição do ruído $\xi(t)$, a forma de se interpretar a integral estocástica 
$\int_0^t f(s, X(s))\,dW_s$ e a questão da existência (e unicidade) de soluções.

Nesta seção, exploraremos cada um desses conceitos, bem como suas propriedades, a fim de justificar rigorosamente a construção de \eqref{eq:ch02_sistema_ede_generico_2}.

\subsection{Processo de Wiener} \label{subsec:ch02_processo_de_wiener}

\subsubsection{Desenvolvimento histórico}\label{subsubsec:desenvolvimento_historico}
Um dos elementos fundamentais para o estudo de equações diferenciais estocásticas é o \textit{movimento browniano}. Trata-se de um fenômeno físico que envolve o estudo do movimento de grãos de pólen suspensos na água.

Historicamente, o problema foi inicialmente proposto e estudado por Robert Brown entre 1826 e 1827. Em seus estudos, Brown observou que a trajetória das partículas era irregular e que o movimento de duas partículas distintas parecia ser independente. Em 1905, Albert Einstein retomou o problema, relacionando-o à equação da difusão\footnote{Detalhes em \citet{Evans2014}}. Esse trabalho foi essencial para a comprovação da existência dos átomos e permitiu, alguns anos depois, que Jean Perrin determinasse experimentalmente a constante de Avogadro \citep{Evans2014}.

Finalmente, na década de 1920, o fenômeno foi formalizado matematicamente por Norbert Wiener. Essa formalização é crucial para a definição rigorosa do movimento browniano, tanto que outra forma de referir-se a ele é \textit{processo de Wiener} — forma que utilizaremos a fim de diferenciar do problema físico original.
    
\subsubsection{Definição}\label{subsubsec:definicao_processo_de_wiener}
Um processo estocástico real, denotado por $W(\cdot)$ é chamado de \textit{processo de Wiener} padrão quando satisfaz as seguintes propriedades:
\begin{enumerate}
    \item $W(0) = 0$, quase certamente;
    \item Para todo $t \geq s \geq 0$, tem-se que $W(t) - W(s) \sim \text{Normal}(0,t-s)$;
    \item $W(\cdot)$ possui incrementos independentes, isto é, para $0 < t_1 < t_2 < \cdots < t_n$, as variáveis aleatórias
    \begin{equation*}
        W(t_1), \; W(t_2) - W(t_1), \; \ldots, \; W(t_n) - W(t_{n-1}) \text{  são independentes.}
    \end{equation*}
\end{enumerate}
\hfill \citep{Evans2014}

A função densidade de probabilidade do processo de Wiener padrão unidimensional, definido como $W(t): \mathbb{R}^+ \to \mathbb{R}$, é dada por:
\begin{equation*} 
f(x; t, s) = \left( 2\pi (t - s) \right)^{-\tfrac{1}{2}} \exp\!\left( -\frac{x^{2}}{2(t - s)} \right). 
\end{equation*}

No caso do processo de Wiener padrão $n$-dimensional, $W(t): \mathbb{R}^+ \to \mathbb{R}^n$, onde cada componente $W_i(t)$, com $i = 1, \ldots, n$, é um processo de Wiener unidimensional independente, a função densidade do vetor gaussiano aleatório $W(t) - W(s)$ é dada por:
\begin{equation*} 
g(\mathbf{x}; t, s) = \left( 2\pi (t - s) \right)^{-n/2} \exp\!\left( -\frac{\|\mathbf{x}\|^2}{2(t - s)} \right). 
\end{equation*}


\subsubsection{Propriedades}\label{subsubsec:propriedades_processo_de_wiener}
As principais propriedades do processo de Wiener padrão são:
\begin{enumerate}
    \item \textbf{Reescalonamento.} Para cada $c > 0$, defina $X_t = \tfrac{1}{\sqrt{c}} W(ct)$. Então $(X_t,\, t \geq 0) = (W_t,\, t \geq 0)$.

    \item \textbf{Translação.} Para cada $c > 0$, $W_{c+t} - W_c$, $t \geq 0$, é um processo de Wiener que é independente de $W_u$, $u \in [0,c]$.

    \item \textbf{Reversão no tempo.} Defina $X_t = W_{1-t} - W_1$, $t \in [0,1]$. Então $(X_t,\, t \in [0,1]) = (W_t,\, t \in [0,1])$.

    \item \textbf{Inversão.} Seja $X_t, t \geq 0$, definido por $X_0 = 0$, $X_t = tW(1/t)$. Então $(X_t,\, t \geq 0) = (W_t,\, t \geq 0)$.
\end{enumerate}
\hfill \citep{Pavliotis2014}

\subsection{Integral estocástica} \label{subsec:ch02_integral_estocastica}
\subsection{Existência e unicidade das soluções} \label{subsec_existencia_e_unicidade_ede}
\subsection{Voltando à motivação}

Dadas as considerações teóricas, voltaremos ao problema que nos motivou.
\begin{equation*}
    \begin{cases}
        \dfrac{dS}{S} = \mu dt + \sigma dW\\
        \mathbf{S}(0) = s_0,
    \end{cases}
\end{equation*}

Aplicando a regra da cadeia de Itô, temos que a solução do problema é dada por:
\begin{equation*}
    S(t) = s_0 \cdot \exp \left( \sigma W(t) + \left( \mu - \frac{\sigma^2}{2}t \right)\right)
\end{equation*}

Dada toda teoria exposta, sabemos que o resultado está bem defiido. Mais que isso, a partir dele podemos realizar uma simulação computacional utilizando a biblioteca \textit{SciML: Open Source Software for Scientific Machine Learning} \citep{Rackauckas2017}. O código-fonte correspondente pode ser consultado no Apêndice \ref{app:apendice-lista-de-programas}.

Para a simulação, adotamos os seguintes parâmetros: $\mu = 0{,}05$, representando uma taxa de crescimento anual de $0{,}05\%$; $\sigma = 1{,}0$, quantificando a volatilidade do mercado no período considerado; e um passo de tempo de $\frac{1}{365 \cdot 24}$, o que corresponde à variação por hora dos preços. Estabelecemos ainda o preço inicial da ação em R\$~12{,}00. Com base nesses parâmetros, obtivemos o gráfico a seguir:

\begin{figure}[H]
    \centering
    \includegraphics[width=0.75\linewidth]{00_TCC/01_LATEX/figuras/ch02_intro_sde/stock_market_evolution.png}
    \caption{Simulação do preço de uma ação a partir da EDE \eqref{eq:ch02_exemplo_mercado_de_acoes}}
    \label{fig:ch02-simulacao-mercado-de-acoes}
\end{figure}

Vale destacar que: por se tratar de um fenômeno aleatório, temos que diferentes simulações geram diferentes resultados. Contudo, nas simualações computacionais, é possível definir o valor de uma \textit{seed} garantindo reprodutibilidade do código.

